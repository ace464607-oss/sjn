<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì„±ì§€ë„· ì•ˆì „ ì¸ì¦ì„¼í„°</title>

  <!-- ì„±ì§€ë„· ê³µí†µ ìŠ¤íƒ€ì¼ (í•„ìš” ì‹œ ìœ ì§€) -->
  <link rel="stylesheet" href="css/style-main.css" />
  <link rel="stylesheet" href="css/style-features.css" />

  <style>
    :root {
      --secure-primary: #1750a6;
      --secure-primary-dark: #123f82;
      --secure-bg: #f3f5fb;
      --secure-card-bg: #ffffff;
      --secure-border: #d0d4dd;
      --secure-text-main: #222;
      --secure-text-sub: #555;
      --secure-text-muted: #888;
      --secure-error: #e03131;
      --secure-radius-card: 18px;
      --secure-radius-input: 10px;
    }

    body.secure-body {
      background: radial-gradient(circle at top left, #e3ebff 0, #f3f5fb 42%, #f5f7fc 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      color: var(--secure-text-main);
    }

    .secure-main-wrapper {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px 12px 32px;
    }

    .secure-page {
      width: 100%;
      max-width: 540px;
      background: var(--secure-card-bg);
      border-radius: var(--secure-radius-card);
      padding: 26px 22px 28px;
      box-shadow:
        0 22px 45px rgba(15, 35, 90, 0.18),
        0 0 0 1px rgba(198, 205, 230, 0.8);
      box-sizing: border-box;
      border: 1px solid rgba(219, 226, 244, 0.9);
    }

    .secure-header-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .secure-mini-brand {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--secure-text-muted);
    }

    .secure-mini-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: #ff5a4d;
    }

    .secure-mini-brand span.brand-main {
      font-weight: 600;
      color: #000;
    }

    .secure-mini-badge {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #f1f4ff;
      color: var(--secure-primary);
      border: 1px solid rgba(23, 80, 166, 0.12);
    }

    .secure-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      background: #eef4ff;
      color: var(--secure-primary);
      margin-bottom: 10px;
    }

    .secure-badge-icon {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: var(--secure-primary);
      color: #fff;
      font-size: 11px;
    }

    .secure-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 4px;
      letter-spacing: -0.02em;
    }

    .secure-subtitle {
      font-size: 13px;
      color: var(--secure-text-sub);
      margin-bottom: 16px;
      line-height: 1.6;
    }

    /* ë‹¨ê³„ íƒ­ ì˜ì—­ */
    .secure-step-indicator {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      font-size: 11px;
      flex-wrap: wrap;
    }

    .secure-step-pill {
      padding: 4px 10px;
      border-radius: 999px;
      background: #f1f3fb;
      color: #666;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      border: 1px solid rgba(180, 188, 210, 0.8);
      transition: background 0.12s ease, color 0.12s ease, border-color 0.12s ease;
    }

    .secure-step-pill::before {
      content: "";
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #c8d0e5;
    }

    .secure-step-pill.active {
      background: var(--secure-primary);
      color: #fff;
      border-color: rgba(23, 80, 166, 0.9);
    }

    .secure-step-pill.active::before {
      background: #ffec99;
    }

    .secure-info-box {
      background: #f7f9ff;
      border-radius: 12px;
      padding: 12px 12px 10px;
      font-size: 11px;
      color: #444;
      margin-bottom: 18px;
      border: 1px solid rgba(204, 213, 255, 0.7);
    }

    .secure-info-box strong {
      font-weight: 700;
    }

    .secure-info-list {
      margin: 6px 0 0;
      padding-left: 16px;
    }

    .secure-step-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      margin-top: 18px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .secure-step-title::before {
      content: "";
      width: 3px;
      height: 14px;
      border-radius: 999px;
      background: var(--secure-primary);
    }

    .secure-form-group {
      margin-bottom: 12px;
    }

    .secure-label {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      margin-bottom: 3px;
    }

    .secure-label span.helper {
      font-size: 11px;
      color: var(--secure-text-muted);
    }

    .secure-input,
    .secure-select {
      width: 100%;
      padding: 11px 12px;
      border-radius: var(--secure-radius-input);
      border: 1px solid var(--secure-border);
      font-size: 14px;
      box-sizing: border-box;
      background: #fff;
      transition: border 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    .secure-input::placeholder,
    .secure-select::placeholder {
      color: #c0c4d0;
    }

    .secure-input:focus,
    .secure-select:focus {
      outline: none;
      border-color: var(--secure-primary);
      box-shadow: 0 0 0 1px rgba(23, 80, 166, 0.18);
      background: #fbfcff;
    }

    .secure-rn-wrapper {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .secure-rn-wrapper input {
      flex: 1;
    }

    .secure-rn-hyphen {
      color: #999;
      font-size: 14px;
    }

    .secure-account-wrapper {
      display: flex;
      gap: 8px;
    }

    .secure-checkbox-group {
      margin-top: 16px;
      font-size: 12px;
    }

    .secure-checkbox-group label {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 6px;
      cursor: pointer;
    }

    .secure-checkbox-group input[type="checkbox"] {
      margin-top: 2px;
      min-width: 16px;
      min-height: 16px;
    }

    .secure-terms-link {
      font-size: 11px;
      color: var(--secure-primary);
      text-decoration: underline;
      cursor: pointer;
    }

    .secure-submit {
      margin-top: 20px;
      width: 100%;
      padding: 13px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      background: var(--secure-primary);
      color: #fff;
      transition: background 0.15s ease, transform 0.05s ease, box-shadow 0.12s ease;
      box-shadow: 0 8px 18px rgba(23, 80, 166, 0.28);
    }

    .secure-submit:not(:disabled):hover {
      background: var(--secure-primary-dark);
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(23, 80, 166, 0.3);
    }

    .secure-submit:disabled {
      background: #c4cad8;
      cursor: not-allowed;
      box-shadow: none;
    }

    .secure-footer-text {
      margin-top: 10px;
      font-size: 11px;
      color: #777;
      text-align: center;
      line-height: 1.5;
    }

    .field-error {
      color: var(--secure-error);
      font-size: 11px;
      margin-top: 3px;
      display: none;
    }

    /* âœ… ëª¨ë°”ì¼ ìµœì í™”: í™”ë©´ ê½‰ ì±„ìš°ê¸° + í¬ê²Œ ë³´ì´ê²Œ */
    @media (max-width: 600px) {
      body.secure-body {
        background: #f5f7fc;
      }

      .secure-main-wrapper {
        padding: 0;
      }

      .secure-page {
        max-width: 100%;
        border-radius: 0;
        min-height: 100vh;
        box-shadow: none;
        border: none;
        padding: 18px 16px 24px;
      }

      .secure-title {
        font-size: 20px;
      }

      .secure-subtitle {
        font-size: 13px;
      }

      .secure-input,
      .secure-select {
        font-size: 15px;
        padding: 12px 13px;
      }

      .secure-label {
        font-size: 13px;
      }

      .secure-step-indicator {
        font-size: 12px;
      }

      .secure-submit {
        font-size: 16px;
        padding: 14px;
        border-radius: 14px;
      }

      .secure-checkbox-group {
        font-size: 12px;
      }
    }
  </style>
</head>

<body class="secure-body">
  <main class="secure-main-wrapper">
    <section class="secure-page" aria-labelledby="secure-title">
      <div class="secure-header-line">
        <div class="secure-mini-brand">
          <span class="brand-main">ì„±ì§€ë„· ì•ˆì „ ì¸ì¦ì„¼í„°</span>
          <span class="secure-mini-dot"></span>
          <span>ë³¸ì¸ í™•ì¸ ë° ê³„ì¢Œ ì¸ì¦</span>
        </div>
        <span class="secure-mini-badge">HTTPS ì•”í˜¸í™”</span>
      </div>

      <div class="secure-badge">
        <span class="secure-badge-icon">ğŸ”’</span>
        <span>ì£¼ë¯¼ë²ˆí˜¸Â·ê³„ì¢Œë²ˆí˜¸, ì—¬ê¸°ì„œ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”</span>
      </div>

      <h1 id="secure-title" class="secure-title">ì „í™”ë¡œ ë§í•˜ì§€ ì•Šê³ , í™”ë©´ì—ì„œ ì§ì ‘ ì…ë ¥</h1>
      <p class="secure-subtitle">
        ìƒë‹´ì›ì´ ì£¼ë¯¼ë²ˆí˜¸Â·ê³„ì¢Œë²ˆí˜¸ë¥¼ ì§ì ‘ ë“£ì§€ ì•Šê³ , ê³ ê°ë‹˜ë§Œ ë³´ëŠ” ì•ˆì „í•œ í™”ë©´ì—ì„œ ì…ë ¥í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>

      <div class="secure-step-indicator">
        <span class="secure-step-pill step-pill active" data-step="1">1. ê¸°ë³¸ ì •ë³´</span>
        <span class="secure-step-pill step-pill" data-step="2">2. ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</span>
        <span class="secure-step-pill step-pill" data-step="3">3. ê³„ì¢Œ ì •ë³´</span>
      </div>

      <div class="secure-info-box">
        <strong>ì•ˆì „í•˜ê²Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.</strong>
        <ul class="secure-info-list">
          <li>ì´ í˜ì´ì§€ëŠ” <strong>ì•”í˜¸í™”(HTTPS)</strong> í†µì‹ ìœ¼ë¡œ ë³´í˜¸ë©ë‹ˆë‹¤.</li>
          <li>ìƒë‹´ ì§ì›ì€ ì£¼ë¯¼ë²ˆí˜¸Â·ê³„ì¢Œë²ˆí˜¸ë¥¼ <strong>ì§ì ‘ ë“£ì§€ ì•ŠìŠµë‹ˆë‹¤.</strong></li>
          <li>ê°€ì… ì²˜ë¦¬ì— í•„ìš”í•œ ë²”ìœ„ ë‚´ì—ì„œë§Œ ì´ìš©ë˜ë©°, ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ <strong>ì•ˆì „í•˜ê²Œ ë³´ê´€Â·íŒŒê¸°</strong>ë©ë‹ˆë‹¤.</li>
        </ul>
      </div>

      <form id="secure-auth-form" novalidate>
        <!-- 1ë‹¨ê³„: ê¸°ë³¸ ì •ë³´ -->
        <h2 class="secure-step-title">1. ê¸°ë³¸ ì •ë³´</h2>

        <div class="secure-form-group">
          <label class="secure-label" for="customer-name">
            <span>ì„±ëª…</span>
            <span class="helper">ê°€ì…ì ëª…ì˜ ê¸°ì¤€</span>
          </label>
          <input
            type="text"
            id="customer-name"
            name="name"
            class="secure-input"
            placeholder="ì˜ˆ) í™ê¸¸ë™"
            pattern="^[a-zA-Zê°€-í£]{2,}$"
            required
          />
          <span class="field-error" id="error-name"></span>
        </div>

        <div class="secure-form-group">
          <label class="secure-label" for="customer-phone">
            <span>íœ´ëŒ€í° ë²ˆí˜¸</span>
            <span class="helper">ì§„í–‰ ì•ˆë‚´ ë° ë³¸ì¸ í™•ì¸ìš©</span>
          </label>
          <input
            type="tel"
            id="customer-phone"
            name="phone"
            class="secure-input"
            placeholder="ì˜ˆ) 010-1234-5678"
            required
          />
          <span class="field-error" id="error-phone"></span>
        </div>

        <!-- 2ë‹¨ê³„: ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ -->
        <h2 class="secure-step-title">2. ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</h2>

        <div class="secure-form-group">
          <label class="secure-label">
            <span>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</span>
            <span class="helper">í†µì‹ ì‚¬ ë³¸ì¸ ì¸ì¦ ë° ê°€ì…ì ë“±ë¡ìš©</span>
          </label>
          <div class="secure-rn-wrapper">
            <input
              type="text"
              inputmode="numeric"
              maxlength="6"
              class="secure-input"
              name="rrn_front"
              id="rrn-front"
              placeholder="ì• 6ìë¦¬ (ì˜ˆ: 900101)"
              required
            />
            <span class="secure-rn-hyphen">-</span>
            <input
              type="password"
              inputmode="numeric"
              maxlength="7"
              class="secure-input"
              name="rrn_back"
              id="rrn-back"
              placeholder="ë’¤ 7ìë¦¬"
              required
            />
          </div>
          <span class="field-error" id="error-rrn"></span>
          <p class="secure-footer-text" style="margin-top:6px;">
            â€¢ ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ëŠ” í†µì‹ ì‚¬ ì „ì‚° ë³¸ì¸ì¸ì¦ì„ ìœ„í•´ ì‚¬ìš©ë˜ë©°,<br />
            &nbsp;&nbsp;ê°€ì… ì²˜ë¦¬ ëª©ì  ì™¸ë¡œ ì €ì¥Â·ì´ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
          </p>
        </div>

        <!-- 3ë‹¨ê³„: ê³„ì¢Œ ì •ë³´ -->
        <h2 class="secure-step-title">3. ê³„ì¢Œ ì •ë³´</h2>

        <div class="secure-form-group">
          <label class="secure-label" for="bank-name">
            <span>ì€í–‰ëª…</span>
          </label>
          <select
            id="bank-name"
            name="bank"
            class="secure-select"
            required
          >
            <option value="">ì€í–‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="êµ­ë¯¼">êµ­ë¯¼ì€í–‰</option>
            <option value="ì‹ í•œ">ì‹ í•œì€í–‰</option>
            <option value="ë†í˜‘">ë†í˜‘ì€í–‰</option>
            <option value="ìš°ë¦¬">ìš°ë¦¬ì€í–‰</option>
            <option value="í•˜ë‚˜">í•˜ë‚˜ì€í–‰</option>
            <option value="ì¹´ì¹´ì˜¤ë±…í¬">ì¹´ì¹´ì˜¤ë±…í¬</option>
            <option value="í† ìŠ¤ë±…í¬">í† ìŠ¤ë±…í¬</option>
          </select>
          <span class="field-error" id="error-bank"></span>
        </div>

        <div class="secure-form-group">
          <label class="secure-label">
            <span>ê³„ì¢Œë²ˆí˜¸</span>
            <span class="helper">ìë™ì´ì²´ ë° ìš”ê¸ˆ ë‚©ë¶€ ê³„ì¢Œ</span>
          </label>
          <div class="secure-account-wrapper">
            <input
              type="text"
              inputmode="numeric"
              class="secure-input"
              id="account-number"
              name="account_number"
              placeholder="ìˆ«ìë§Œ ì…ë ¥"
              required
            />
          </div>
          <span class="field-error" id="error-account"></span>
        </div>

        <!-- ë™ì˜ ì˜ì—­ -->
        <div class="secure-checkbox-group">
          <!-- ì „ì²´ ë™ì˜ -->
          <label>
            <input type="checkbox" id="agree-all" />
            <span>
              (ì „ì²´ ë™ì˜) ì•„ë˜ í•­ëª© ì „ì²´ì— ë™ì˜í•©ë‹ˆë‹¤.
            </span>
          </label>

          <label>
            <input type="checkbox" id="agree-privacy" required />
            <span>
              (í•„ìˆ˜) ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë° ì „ìì  ì „ì†¡ì— ë™ì˜í•©ë‹ˆë‹¤.<br />
              <span class="secure-terms-link" onclick="openPrivacyPolicy()">
                ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë³´ê¸°
              </span>
            </span>
          </label>
          <label>
            <input type="checkbox" id="agree-telecom" required />
            <span>
              (í•„ìˆ˜) ì„ íƒí•˜ì‹  í†µì‹ ì‚¬ ê°€ì… ë° ë³¸ì¸ ì¸ì¦ì„ ìœ„í•œ ì •ë³´ ì œê³µì— ë™ì˜í•©ë‹ˆë‹¤.
            </span>
          </label>
          <label>
            <input type="checkbox" id="agree-marketing" />
            <span>
              (ì„ íƒ) í• ì¸/í”„ë¡œëª¨ì…˜ ì•ˆë‚´ ë¬¸ì ìˆ˜ì‹ ì— ë™ì˜í•©ë‹ˆë‹¤.
            </span>
          </label>
        </div>

        <button
          type="submit"
          id="secure-submit-btn"
          class="secure-submit"
          disabled
        >
          ì•ˆì „í•˜ê²Œ ì „ì†¡í•˜ê¸°
        </button>

        <p class="secure-footer-text">
          ì„±ì§€ë„·ì€ ê³ ê°ë‹˜ì˜ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ë³´í˜¸í•˜ê¸° ìœ„í•´ ë…¸ë ¥í•©ë‹ˆë‹¤.<br />
          ì „í™”ë¡œ ë§ì”€í•˜ì‹œê¸° ë¶€ë‹´ìŠ¤ëŸ¬ìš´ ì •ë³´ëŠ” ì´ í™”ë©´ì—ì„œë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
        </p>
      </form>
    </section>
  </main>

  <script>
    const form = document.getElementById('secure-auth-form');
    const submitBtn = document.getElementById('secure-submit-btn');

    const nameInput = document.getElementById('customer-name');
    const phoneInput = document.getElementById('customer-phone');
    const rrnFrontInput = document.getElementById('rrn-front');
    const rrnBackInput = document.getElementById('rrn-back');
    const bankSelect = document.getElementById('bank-name');
    const accountInput = document.getElementById('account-number');

    const errorName = document.getElementById('error-name');
    const errorPhone = document.getElementById('error-phone');
    const errorRrn = document.getElementById('error-rrn');
    const errorBank = document.getElementById('error-bank');
    const errorAccount = document.getElementById('error-account');

    const agreePrivacy = document.getElementById('agree-privacy');
    const agreeTelecom = document.getElementById('agree-telecom');
    const agreeMarketing = document.getElementById('agree-marketing');
    const agreeAll = document.getElementById('agree-all');

    const stepPills = document.querySelectorAll('.step-pill');

    function setActiveStep(step) {
      stepPills.forEach(pill => {
        if (pill.dataset.step === String(step)) {
          pill.classList.add('active');
        } else {
          pill.classList.remove('active');
        }
      });
    }

    function showError(span, message) {
      span.textContent = message;
      span.style.display = 'block';
    }

    function clearError(span) {
      span.textContent = '';
      span.style.display = 'none';
    }

    function validateName() {
      const value = nameInput.value.trim();
      const pattern = /^[a-zA-Zê°€-í£]{2,}$/;
      if (!pattern.test(value)) {
        showError(errorName, 'ì´ë¦„ì€ 2ê¸€ì ì´ìƒ, í•œê¸€ ë˜ëŠ” ì˜ë¬¸ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return false;
      }
      clearError(errorName);
      return true;
    }

    // íœ´ëŒ€í° ë²ˆí˜¸: ìë™ í•˜ì´í”ˆ + ìˆ«ì ê¸°ì¤€ ìœ íš¨ì„± ê²€ì‚¬
    function autoHyphenPhone(value) {
      value = value.replace(/[^0-9]/g, "");
      if (value.length < 4) return value;
      if (value.length < 7) return value.replace(/(01[0-9])([0-9]+)/, "$1-$2");
      return value.replace(/(01[0-9])([0-9]{3,4})([0-9]+)/, "$1-$2-$3");
    }

    function validatePhone() {
      const raw = phoneInput.value.trim();
      const digits = raw.replace(/[^0-9]/g, "");
      const pattern = /^01[0-9]{8,9}$/;
      if (!pattern.test(digits)) {
        showError(errorPhone, 'íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì˜ˆ: 010-1234-5678)');
        return false;
      }
      clearError(errorPhone);
      return true;
    }

    // ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ìœ íš¨ì„± ì•Œê³ ë¦¬ì¦˜(ì²´í¬ì„¬) í¬í•¨
    function validateRrn() {
      const front = rrnFrontInput.value.trim();
      const back = rrnBackInput.value.trim();
      const patternFront = /^[0-9]{6}$/;
      const patternBack = /^[0-9]{7}$/;

      if (!patternFront.test(front) || !patternBack.test(back)) {
        showError(errorRrn, 'ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ì• 6ìë¦¬, ë’¤ 7ìë¦¬ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        setActiveStep(2);
        return false;
      }

      const rrn = front + back;
      if (rrn.length !== 13) {
        showError(errorRrn, 'ìœ íš¨í•˜ì§€ ì•Šì€ ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ì…ë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
        setActiveStep(2);
        return false;
      }

      const digits = rrn.split('').map(d => parseInt(d, 10));
      if (digits.some(d => Number.isNaN(d))) {
        showError(errorRrn, 'ìœ íš¨í•˜ì§€ ì•Šì€ ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ì…ë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
        setActiveStep(2);
        return false;
      }

      const weights = [2,3,4,5,6,7,8,9,2,3,4,5];
      let sum = 0;
      for (let i = 0; i < 12; i++) {
        sum += digits[i] * weights[i];
      }
      const check = (11 - (sum % 11)) % 10;

      if (check !== digits[12]) {
        showError(errorRrn, 'ìœ íš¨í•˜ì§€ ì•Šì€ ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ì…ë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
        setActiveStep(2);
        return false;
      }

      clearError(errorRrn);
      return true;
    }

    // ì€í–‰ë³„ ê³„ì¢Œë²ˆí˜¸ íŒ¨í„´ ê²€ì‚¬
    function validateAccount() {
      const value = accountInput.value.trim();
      const bank = bankSelect.value;

      if (!bank) {
        showError(errorAccount, 'ë¨¼ì € ì€í–‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        setActiveStep(3);
        return false;
      }

      if (!/^[0-9]+$/.test(value)) {
        showError(errorAccount, 'ê³„ì¢Œë²ˆí˜¸ëŠ” ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        setActiveStep(3);
        return false;
      }

      let minLen = 8;
      let maxLen = 14;

      switch (bank) {
        case 'êµ­ë¯¼':
        case 'ì‹ í•œ':
        case 'ìš°ë¦¬':
        case 'í•˜ë‚˜':
          minLen = 10; maxLen = 14;
          break;
        case 'ë†í˜‘':
          minLen = 11; maxLen = 14;
          break;
        case 'ì¹´ì¹´ì˜¤ë±…í¬':
        case 'í† ìŠ¤ë±…í¬':
          minLen = 10; maxLen = 13;
          break;
        default:
          minLen = 8; maxLen = 14;
      }

      if (value.length < minLen || value.length > maxLen) {
        showError(
          errorAccount,
          bank + ' ê³„ì¢Œë²ˆí˜¸ ê¸¸ì´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (ìˆ«ì ' + minLen + ' ~ ' + maxLen + 'ìë¦¬)'
        );
        setActiveStep(3);
        return false;
      }

      clearError(errorAccount);
      return true;
    }

    function validateBank() {
      if (!bankSelect.value) {
        showError(errorBank, 'ì€í–‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        setActiveStep(3);
        return false;
      }
      clearError(errorBank);
      return true;
    }

    function updateSubmitState() {
      const valid =
        validateName() &&
        validatePhone() &&
        validateRrn() &&
        validateBank() &&
        validateAccount() &&
        agreePrivacy.checked &&
        agreeTelecom.checked;

      submitBtn.disabled = !valid;
    }

    function syncAgreeAll() {
      agreeAll.checked =
        agreePrivacy.checked &&
        agreeTelecom.checked &&
        agreeMarketing.checked;
    }

    // ì „ì²´ ë™ì˜ í´ë¦­ ì‹œ ê°œë³„ ë™ì˜ ì œì–´
    agreeAll.addEventListener('change', () => {
      const checked = agreeAll.checked;
      agreePrivacy.checked = checked;
      agreeTelecom.checked = checked;
      agreeMarketing.checked = checked;
      updateSubmitState();
    });

    [agreePrivacy, agreeTelecom, agreeMarketing].forEach(box => {
      box.addEventListener('change', () => {
        syncAgreeAll();
        updateSubmitState();
      });
    });

    // ì…ë ¥ í¬ì»¤ìŠ¤/ì…ë ¥ì— ë”°ë¼ ë‹¨ê³„ í•˜ì´ë¼ì´íŠ¸ ë³€ê²½
    [nameInput, phoneInput].forEach(input => {
      input.addEventListener('focus', () => setActiveStep(1));
      input.addEventListener('input', () => {
        if (input === phoneInput) {
          phoneInput.value = autoHyphenPhone(phoneInput.value);
        }
        updateSubmitState();
      });
    });

    [rrnFrontInput, rrnBackInput].forEach(input => {
      input.addEventListener('focus', () => setActiveStep(2));
      input.addEventListener('input', () => {
        updateSubmitState();
      });
    });

    [bankSelect, accountInput].forEach(input => {
      input.addEventListener('focus', () => setActiveStep(3));
      input.addEventListener('input', () => {
        updateSubmitState();
      });
      if (input.tagName && input.tagName.toLowerCase() === 'select') {
        input.addEventListener('change', () => {
          setActiveStep(3);
          updateSubmitState();
        });
      }
    });

    function openPrivacyPolicy() {
      alert('ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤. (êµ¬í˜„ í•„ìš”)');
    }

    form.addEventListener('submit', function (e) {
      e.preventDefault();

      updateSubmitState();
      if (submitBtn.disabled) {
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = 'ì „ì†¡ ì¤‘â€¦';
      setActiveStep(3);

      // TODO: ì‹¤ì œ ì „ì†¡ ë¡œì§ êµ¬í˜„ (HTTPS í™˜ê²½, ë³¸ì¸ì¸ì¦/ê³„ì¢Œì¸ì¦ ëª¨ë“ˆ ì—°ë™ ë“±)
      setTimeout(function () {
        alert('ì¸ì¦ ì •ë³´ê°€ ì•ˆì „í•˜ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\nìƒë‹´ì›ì´ ê°€ì… ì§„í–‰ì„ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
        submitBtn.textContent = 'ì•ˆì „í•˜ê²Œ ì „ì†¡í•˜ê¸°';
        form.reset();
        [errorName, errorPhone, errorRrn, errorBank, errorAccount].forEach(clearError);
        agreeAll.checked = false;
        agreePrivacy.checked = false;
        agreeTelecom.checked = false;
        agreeMarketing.checked = false;
        submitBtn.disabled = true;
        setActiveStep(1);
      }, 1200);
    });
  </script>
</body>
</html>
