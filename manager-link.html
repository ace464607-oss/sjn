<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„±ì§€ë„· - ìƒë‹´ì‚¬ ë§í¬ ìƒì„±ê¸°</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* ... (ê¸°ì¡´ ìŠ¤íƒ€ì¼ ë™ì¼) ... */
        body { font-family: 'Noto Sans KR', sans-serif; background: #f0f2f5; padding: 20px; display: flex; justify-content: center; }
        .admin-card { background: white; width: 100%; max-width: 500px; padding: 30px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h2 { text-align: center; margin-bottom: 25px; color: #333; }
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 700; margin-bottom: 8px; color: #555; }
        select, input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        .preview-box { background: #f8f9fa; padding: 15px; border-radius: 8px; display: flex; align-items: center; gap: 15px; margin-bottom: 20px; border: 1px solid #eee; }
        .preview-img { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; border: 1px solid #ddd; }
        .preview-info div { font-size: 14px; }
        .preview-info strong { font-size: 16px; color: #333; }
        .btn-generate { width: 100%; background: #007bff; color: white; padding: 15px; border: none; border-radius: 8px; font-size: 18px; font-weight: 700; cursor: pointer; }
        .btn-generate:hover { background: #0056b3; }
        .result-area { margin-top: 25px; display: none; }
        .result-url { width: 100%; background: #e9ecef; padding: 10px; border-radius: 8px; word-break: break-all; font-size: 13px; color: #555; margin-bottom: 10px; }
        .btn-copy { width: 100%; background: #28a745; color: white; padding: 12px; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; }
        .link-to-admin { display: block; text-align: center; margin-top: 20px; font-size: 13px; color: #888; text-decoration: none; }
        .link-to-admin:hover { text-decoration: underline; }
    </style>
</head>
<body>

    <div class="admin-card">
        <h2>ğŸ‘©â€ğŸ’¼ ìƒë‹´ì‚¬ ë§í¬ ìƒì„±ê¸°</h2>

        <div class="form-group">
            <label>ìƒë‹´ì‚¬ ì„ íƒ (ë³¸ì¸)</label>
            <select id="manager-select">
                <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
            </select>
        </div>

        <div class="preview-box" id="manager-preview" style="display:none;">
            <img src="" class="preview-img" id="prev-img">
            <div class="preview-info">
                <strong id="prev-name"></strong> <span id="prev-role" style="font-size:11px; color:#666; border:1px solid #ddd; padding:1px 4px; border-radius:4px;"></span><br>
                <span id="prev-team" style="font-size:12px; color:#007bff;"></span><br>
                <span id="prev-phone"></span>
            </div>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

        <div class="form-group">
            <label>ê³ ê° ì´ë¦„</label>
            <input type="text" id="customer-name" placeholder="ì˜ˆ: í™ê¸¸ë™">
        </div>
        
        <div class="form-group">
            <label>ì¶”ì²œ ìƒí’ˆ (ì„ íƒ)</label>
            <input type="text" id="product-name" placeholder="ì˜ˆ: LG 500M + TV" value="LG 1G + í”„ë¦¬ë¯¸ì—„ TV">
        </div>

        <button class="btn-generate" onclick="generateLink()">ğŸ”— ë§í¬ ìƒì„±í•˜ê¸°</button>

        <div class="result-area" id="result-area">
            <label>ìƒì„±ëœ ë§í¬ (ë³µì‚¬í•´ì„œ ê³ ê°ì—ê²Œ ì „ì†¡)</label>
            <div class="result-url" id="final-url"></div>
            <button class="btn-copy" onclick="copyLink()">ğŸ“‹ ë§í¬ ë³µì‚¬í•˜ê¸°</button>
        </div>

        <a href="admin-managers.html" class="link-to-admin" target="_blank">âš™ï¸ ìƒë‹´ì‚¬ í”„ë¡œí•„ ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™</a>
    </div>

    <script>
        // [ìˆ˜ì •] localStorageì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function getManagers() {
            const data = localStorage.getItem('sjnet_managers');
            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì œê³µ
            return data ? JSON.parse(data) : [
                { id: "default", name: "í™ì—°ì£¼", phone: "010-1234-5678", team: "ì†”ë£¨ì…˜ì œì•ˆíŒ€", role: "MANAGER", img: "assets/images/manager_placeholder.png" }
            ];
        }

        const managers = getManagers();
        const selectEl = document.getElementById('manager-select');
        const previewEl = document.getElementById('manager-preview');
        
        managers.forEach(m => {
            const option = document.createElement('option');
            option.value = m.id;
            option.textContent = `${m.name} (${m.team})`;
            selectEl.appendChild(option);
        });

        selectEl.addEventListener('change', function() {
            const selectedId = this.value;
            // ID ë¹„êµ ì‹œ í˜•ë³€í™˜ ì£¼ì˜ (Date.now()ëŠ” ìˆ«ìì¼ ìˆ˜ ìˆìŒ)
            const manager = managers.find(m => String(m.id) === String(selectedId));

            if (manager) {
                document.getElementById('prev-img').src = manager.img;
                document.getElementById('prev-name').textContent = manager.name;
                document.getElementById('prev-phone').textContent = manager.phone;
                document.getElementById('prev-team').textContent = manager.team;
                document.getElementById('prev-role').textContent = manager.role;
                previewEl.style.display = 'flex';
            } else {
                previewEl.style.display = 'none';
            }
        });

        function generateLink() {
            const selectedId = selectEl.value;
            if (!selectedId) { alert('ìƒë‹´ì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }

            const manager = managers.find(m => String(m.id) === String(selectedId));
            const customerName = document.getElementById('customer-name').value.trim() || 'ê³ ê°';
            const product = document.getElementById('product-name').value.trim();

            const baseUrl = window.location.origin + "/quote.html";

            const params = new URLSearchParams();
            params.set('name', customerName);
            params.set('manager', manager.name);
            params.set('phone', manager.phone);
            params.set('managerImg', manager.img);
            // [ì¶”ê°€] íŒ€ëª…ê³¼ ì§ì±…ë„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
            params.set('team', manager.team);
            params.set('role', manager.role);

            if(product) params.set('product', product);
            
            // ì˜ˆì‹œ ê¸ˆì•¡
            params.set('originalPrice', '55000');
            params.set('price', '38500');
            params.set('gift', '470000');
            params.set('secret', '30000');
            params.set('saving', '600000');

            const finalUrl = `${baseUrl}?${params.toString()}`;
            
            document.getElementById('final-url').textContent = finalUrl;
            document.getElementById('result-area').style.display = 'block';
        }

        function copyLink() {
            const urlText = document.getElementById('final-url').textContent;
            navigator.clipboard.writeText(urlText).then(() => {
                alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }
    </script>
</body>
</html>